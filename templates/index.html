<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Translator</title>
    <link rel="stylesheet" type="text/css" href="/translate/static/style.css" />
  </head>
  <body>
    <div class="alert">
      <h1>Hai! Selamat Datang...</h1>
      <h3>Mari memulai !</h3>
      <button id="btnNext" onclick="next()">Selanjutnya</button>
    </div>
    <div class="section">
      <div class="main">
        <h1>Terjemahan Nama Hewan</h1>
        <form id="translationForm" method="get" action="/translate">
          <label for="translate"
            >Masukkan nama hewan yang ingin di terjemahkan:</label
          >
          <br />
          <input type="text" id="translateInput" required />
          <br />
          <label for="pilihan"
            >Pilih Bahasa : </label
          >
          <br />
          <br />
          <select id="pilihanInput" required>
            <option value="">Bahasa...</option>
            <option value="bahasa indonesia">Bahasa Indonesia</option>
            <option value="bahasa inggris">Bahasa Inggris</option>
            <option value="bahasa jepang">Bahasa Jepang</option>
          </select>
          <br />
          <button type="button" onclick="doTranslation()" id="btn">
            Terjemahkan
          </button>
        </form>

        <div class="hasil">
          <p type="text" id="resultContainer"></p>
        </div>
      </div>
    </div>

    <script>
      const myAlert = document.querySelector(".alert");
      const myContent = document.querySelector(".section");
      const btnNext = document.getElementById("btnNext");

      function next(){
        btnNext.addEventListener("click", () => {
          myAlert.style.display = "none";
          myContent.classList.add("animated");
          myContent.style.display = "block";
        });
      }

      function doTranslation() {
        var translateInput = document.getElementById("translateInput").value;
        var pilihanInput = document.getElementById("pilihanInput").value;
        var url =
          "/translate/templates?translate=" +
          encodeURIComponent(translateInput) +
          "&pilihan=" +
          encodeURIComponent(pilihanInput);

        var xhr = new XMLHttpRequest();

        xhr.open("GET", url, true);

        xhr.onreadystatechange = function () {
          if (xhr.readyState == 4) {
            if (xhr.status == 200) {
              var response = JSON.parse(xhr.responseText);
              if ("terjemahan" in response) {
                document.getElementById("resultContainer").innerHTML =
                  "<p>" + response.terjemahan + "</p>";
              } else {
                alert("Error: " + response.error);
              }
            } else {
              alert("Error: " + xhr.status);
            }
          }
        };

        xhr.send();
      }

      function handleInvalidJSONResponse(responseText) {
        console.error("Invalid JSON response:", responseText);
      }
    </script>
  </body>
</html>
